---
title: "AoL DMV"
author: "Group 2"
date: "2025-06-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE,warning=FALSE,message=FALSE,fig.width = 7,fig.height = 5)
```

# Analisis Klasifikasi Kemiskinan di Indonesia {.tabset}
```{r}
library(ggplot2)
library(tidyverse)
library(plotly)
```

```{r}
df<-read.csv("global_education_data.csv")
df <- df[-156,]
```

```{r,results='hide'}
summary(df)
```
## OOSR per jenjang dan per gender
```{r}
# Prepare data for OOSR distribution - calculate mean and standard error
oosr_summary <- df %>%
  select(Countries.and.areas, 
         OOSR_Primary_Age_Male, OOSR_Primary_Age_Female,
         OOSR_Lower_Secondary_Age_Male, OOSR_Lower_Secondary_Age_Female,
         OOSR_Upper_Secondary_Age_Male, OOSR_Upper_Secondary_Age_Female) %>%
  pivot_longer(cols = -Countries.and.areas, 
               names_to = "Category", 
               values_to = "Rate") %>%
  filter(!is.na(Rate)) %>%
  mutate(
    Level = case_when(
      str_detect(Category, "Primary") ~ "Primary",
      str_detect(Category, "Lower_Secondary") ~ "Lower Secondary",
      str_detect(Category, "Upper_Secondary") ~ "Upper Secondary"
    ),
    Gender = ifelse(str_detect(Category, "Male"), "Male", "Female"),
    Level = factor(Level, levels = c("Primary", "Lower Secondary", "Upper Secondary"))
  ) %>%
  group_by(Level, Gender) %>%
  summarise(
    Mean_OOSR = mean(Rate, na.rm = TRUE),
    SE_OOSR = sd(Rate, na.rm = TRUE) / sqrt(n()),
    .groups = 'drop'
  )

plot1 <- ggplot(oosr_summary, aes(x = Level, y = Mean_OOSR, fill = Gender)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  scale_fill_manual(values = c("Female" = "#FF6B6B", "Male" = "#4ECDC4")) +
  labs(title = "Rata-rata Anak Tidak Bersekolah (OOSR) per Jenjang dan Gender",
       x = "Jenjang Pendidikan",
       y = "Rata-rata OOSR (%)") + theme_minimal() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))

ggplotly(plot1)
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Berdasarkan diagram batang rata-rata OOSR (Out-of-School Rate) di atas, terlihat pola yang jelas mengenai akses pendidikan global. Pertama, tingkat OOSR meningkat secara konsisten seiring dengan jenjang pendidikan yang lebih tinggi untuk kedua gender. Pada jenjang Primary (SD), rata-rata OOSR berada di kisaran 5% untuk kedua gender, menunjukkan bahwa sebagian besar anak usia SD sudah memiliki akses ke pendidikan dasar. Namun, pada jenjang Lower Secondary (SMP), terjadi peningkatan menjadi sekitar 3% membuat rata - rata OOSR lower secondary untuk kedua gender menjadi sekitar 8-9%, dan pada Upper Secondary (SMA) OOSR melonjak dramatis menjadi 19-20%.

## Completion rate analysis {.tabset}
#### Scatterplot dibawah menunjukan kesetaraan gender dalam tingkat kelulusan pada setiap negara. Setiap point menunjukan persentase kelulusan laki-laki (x) dan perempuan (y), dengan garis putus-putus merah ditengah menandakan setara (x=y).
### Completion Rate Analysis on Primary Education
```{r}
completion_data <- df %>%
  select(Countries.and.areas,
         Completion_Rate_Primary_Male, Completion_Rate_Primary_Female,
         Completion_Rate_Lower_Secondary_Male, Completion_Rate_Lower_Secondary_Female,
         Completion_Rate_Upper_Secondary_Male, Completion_Rate_Upper_Secondary_Female) %>%
  filter(!is.na(Completion_Rate_Primary_Male) & !is.na(Completion_Rate_Primary_Female))

plot2 <- ggplot(completion_data, aes(x = Completion_Rate_Primary_Male, 
                                     y = Completion_Rate_Primary_Female,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#3498db") +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
  labs(title = "Kesetaraan Gender dalam Tingkat Kelulusan Pendidikan Dasar",
       x = "Tingkat Kelulusan Primary - Laki-laki (%)",
       y = "Tingkat Kelulusan Primary - Perempuan (%)") +
  theme_minimal() +
  coord_fixed(ratio = 1)
ggplotly(plot2,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik perbandingan kelulusan untuk pendidikan dasar, dapat dilihat bahwa banyak point yang berada diatas garis merah pada negara yang memiliki persentase tinggi, ini berarti persentase kelulusan pendidikan dasar untuk perempuan lebih banyak daripada laki-laki. Sedangkan negara-negara yang memiliki persentase rendah lebih banyak memiliki tingkat kelulusan laki-laki dibanding perempuan (seperti South Sudan, Niger, Central African Republic, dan Afghanistan). Terdapat satu outlier yaitu Venezuela yang memiliki tingkat kelulusan 0% untuk kedua gender.

### Completion Rate Analysis on Lower Secondary Education
```{r}
completion_data2 <- df %>%
  select(Countries.and.areas,
         Completion_Rate_Primary_Male, Completion_Rate_Primary_Female,
         Completion_Rate_Lower_Secondary_Male, Completion_Rate_Lower_Secondary_Female,
         Completion_Rate_Upper_Secondary_Male, Completion_Rate_Upper_Secondary_Female) %>%
  filter(!is.na(Completion_Rate_Lower_Secondary_Male) & !is.na(Completion_Rate_Lower_Secondary_Female))

plot3 <- ggplot(completion_data2, aes(x = Completion_Rate_Lower_Secondary_Male, 
                                     y = Completion_Rate_Lower_Secondary_Female,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#3498db") +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
  labs(title = "Kesetaraan Gender dalam Tingkat Kelulusan Pendidikan Menengah Pertama",
       x = "Tingkat Kelulusan Lower Secondary - Laki-laki (%)",
       y = "Tingkat Kelulusan Lower Secondary - Perempuan (%)") +
  theme_minimal() +
  coord_fixed(ratio = 1)

ggplotly(plot3,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik perbandingan kelulusan untuk pendidikan menengah, dapat terlihat trend yang hampir sama dengan perbandingan kelulusan pendidikan bawah dimana negara yang memiliki persentase kelulusan tinggi memiliki lebih banyak kelulusan perempuan dibanding negara yang memiliki kelulusan rendah yang memiliki lebih banyak kelulusan laki-laki. Namun untuk pendidikan menengah dapat terlihat lebih banyak variasi dimana setiap point lebih jauh dari garis merah tengah yang berarti perbedaan antara gender lebih besar.

### Completion Rate Analysis on Upper Secondary Education
```{r}
completion_data3 <- df %>%
  select(Countries.and.areas,
         Completion_Rate_Primary_Male, Completion_Rate_Primary_Female,
         Completion_Rate_Lower_Secondary_Male, Completion_Rate_Lower_Secondary_Female,
         Completion_Rate_Upper_Secondary_Male, Completion_Rate_Upper_Secondary_Female) %>%
  filter(!is.na(Completion_Rate_Upper_Secondary_Male) & !is.na(Completion_Rate_Upper_Secondary_Female))

plot4 <- ggplot(completion_data3, aes(x = Completion_Rate_Upper_Secondary_Male, 
                                      y = Completion_Rate_Upper_Secondary_Female,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#3498db") +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
  labs(title = "Kesetaraan Gender dalam Tingkat Kelulusan Pendidikan Menengah Atas",
       x = "Tingkat Kelulusan Upper Secondary - Laki-laki (%)",
       y = "Tingkat Kelulusan Upper Secondary - Perempuan (%)") +
  theme_minimal() +
  coord_fixed(ratio = 1)

ggplotly(plot4,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik perbandingan kelulusan untuk pendidikan atas, dapat terlihat bahwa persebaran point lebih bervariasi. Terdapat banyak negara yang terletak jauh dari garis merah yang berarti terdapat perbedaan antar gender yang besar. Untuk pendidikan atas, lebih banyak negara yang memiliki persentase kelulusan perempuan yang lebih besar daripada laki-laki.

## Average of Proficiency in Primary Education and Lower Secondary Education
```{r}
proficiency_summary <- df %>%
  select(Countries.and.areas,
         Primary_End_Proficiency_Reading,
         Primary_End_Proficiency_Math,
         Lower_Secondary_End_Proficiency_Reading,
         Lower_Secondary_End_Proficiency_Math)%>%
  pivot_longer(cols = -Countries.and.areas,
               names_to = "Category",
               values_to = "Proficiency") %>%
  filter(!is.na(Proficiency)) %>%
  mutate(
    Level = ifelse(str_detect(Category, "Primary"), "Primary", "Lower Secondary"),
    Subject = ifelse(str_detect(Category, "Reading"), "Reading", "Math"),
    Level = factor(Level, levels = c("Primary", "Lower Secondary"))
  ) %>%
  group_by(Level, Subject) %>%
  summarise(
    Mean_Proficiency = mean(Proficiency, na.rm = TRUE),
    .groups = 'drop'
  )

plot5 <- ggplot(proficiency_summary, aes(x = Subject, y = Mean_Proficiency, fill = Level)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
  scale_fill_manual(values = c("Primary" = "#9b59b6", "Lower Secondary" = "#f39c12")) +
  labs(title = "Rata-rata Tingkat Profisiensi Akademik di Jenjang Dasar dan Menengah Pertama",
       x = "Mata Pelajaran",
       y = "Rata-rata Profisiensi (%)") +
  theme_minimal()

ggplotly(plot5)
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik Rata-rata Tingkat Profisiensi Akademik di Jenjang Pendidikan Dasar dan Pendidikan Menengah menampilkan perbandingan rata-rata profisiensi (%) siswa SD (Primary) dan SMP (Lower Secondary) dalam dua mata pelajaran: Matematika dan Membaca.SMP (Lower Secondary) memiliki tingkat profisiensi lebih tinggi dibanding SD (Primary) untuk kedua mata pelajaran. Dimana rata rata untuk pelajaran Matematika SD (~10.4), SMP (~24.5), sedangkan untuk pelajaran Membaca SD(~11), SMP(~26). Hal ini menunjukkan pertumbuhan yang positif.

## Relationships{.tabset}
### Relationship of Completion Rate and Unemployment Rate
```{r}
completion_unemployment <- df %>%
  mutate(
    Avg_Completion = rowMeans(select(., contains("Completion_Rate")), na.rm = TRUE)
  ) %>%
  filter(!is.na(Avg_Completion) & !is.na(Unemployment_Rate))

plot5a <- ggplot(completion_unemployment, aes(x = Avg_Completion, y = Unemployment_Rate,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#e74c3c", size = 3) +
  labs(title = "Hubungan Tingkat Kelulusan dan Pengangguran",
       subtitle = "Rata-rata tingkat kelulusan semua jenjang vs tingkat pengangguran",
       x = "Rata-rata Tingkat Kelulusan (%)",
       y = "Tingkat Pengangguran (%)") +
  theme_minimal()

ggplotly(plot5a,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik Hubungan Tingkat Kelulusan dan Pengangguran, dimana membandingkan Rata-rata tingkat kelulusan semua jenjang vs tingkat pengangguran. Terlihat titik scatter tersebar secara luas membentuk pola yang tidak jelas, dimana hal ini berarti tidak ada hubungan kuat antara tingkat kelulusan dan pengangguran secara langsung. Tingginya kelulusan tidak otomatis membuat tingkat pengangguran rendah begitu juga sebaliknya. Hal ini mungkin dipengaruhi oleh faktor lain seperti kualitas pendidikan, lapangan kerja, keterampilan kelulusan dan lain lain.

### Relationship of OOSR(Out of School Rate) and Unemployment Rate
```{r}
oosr_unemployment <- df %>%
  mutate(
    Avg_OOSR = rowMeans(select(., contains("OOSR")), na.rm = TRUE)
  ) %>%
  filter(!is.na(Avg_OOSR) & !is.na(Unemployment_Rate))

plot5b <- ggplot(oosr_unemployment, aes(x = Avg_OOSR, y = Unemployment_Rate,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#9b59b6", size = 3) +
  labs(title = "Hubungan OOSR dan Pengangguran",
       subtitle = "Rata-rata anak tidak bersekolah vs tingkat pengangguran",
       x = "Rata-rata OOSR (%)",
       y = "Tingkat Pengangguran (%)") +
  theme_minimal()

ggplotly(plot5b,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik Hubungan OOSR dan Pengangguran, dimana membandingkan Rata-rata anak tidak bersekolah vs tingkat pengangguran. Dapat dilihat sebagian besar data terkonsentrasi di bagian kiri bawah (OOSR rendah, pengangguran juga rendah). Titik-titik menyebar tanpa pola yang jelas, meskipun ada kecenderungan bahwa semakin tinggi OOSR, tingkat pengangguran bisa ikut tinggi. Artinya ada hubungan lemah bahwa semakin banyak anak yang tidak sekolah (OOSR tinggi), maka pengangguran cenderung lebih rendah. Namun, hubungan tidak kuat secara visual dan bisa dipengaruhi faktor lain.

### Relationship of Proficiency and Unemployment Rate
```{r}
proficiency_unemployment <- df %>%
  mutate(
    Avg_Proficiency = rowMeans(select(., contains("Proficiency")), na.rm = TRUE)
  ) %>%
  filter(!is.na(Avg_Proficiency) & !is.na(Unemployment_Rate))

plot5c <- ggplot(proficiency_unemployment, aes(x = Avg_Proficiency, y = Unemployment_Rate,text=Countries.and.areas)) +
  geom_point(alpha = 0.6, color = "#16a085", size = 3) +
  labs(title = "Hubungan Profisiensi Akademik di Pendidikan Dasar dan Pendidikan Menengah dengan Pengangguran",
       subtitle = "Rata-rata kemampuan akademik vs tingkat pengangguran",
       x = "Rata-rata Profisiensi (%)",
       y = "Tingkat Pengangguran (%)") +
  theme_minimal()

ggplotly(plot5c,tooltip=c("text","x","y"))
```
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dari grafik Hubungan Profisiensi Akademik di Pendidikan Dasar dan Pendidikan Menengah dengan Pengangguran, dimana membandingkan Kemampuan Akademik dan Tingkat Pengangguran. Dapat dilihat data tersebar luas tanpa pola yang jelas. Banyak titik profisiensi rendah tapi pengangguran tetap bervariasi, begitu juga sebalikanya. Artinya tidak terlihat jelas hubungan antara profisiensi akademik tingkat SD dan Sekolah Menengah. Tingkat kemampuan akademik saja tidak cukup untuk menentukan tinggi rendahnya pengangguran.
